<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MWD-Assignment 2</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="header">
    <h1>♻️ Shop Second Hand ♻️</h1>
    <h5>Find all the thirft-shops in the area</h5>
    <p>"Thrifting is important because it helps reduce waste by reusing items that would otherwise go to landfills, saves money by providing affordable options, supports local communities by funding charities through thrift store profits, and allows people to express their unique style through a wider variety of unique finds; essentially, it's a sustainable and budget-friendly way to shop while contributing positively to the environment and society. "</p>
        <div id="btns">
            <button id="onlyVV">Only Value Village</button>
            <button id="onlyTS">Only Talize</button>
            <button id="onlySA">Only Salvation Army</button>
            <button id="all">Display All</button>
        </div>
    </div>
    
    <div id="maps"></div>
    
    <div class="text-center">
        <button id="findLocation">Find My Location</button>
        <div id="coords"></div>
    </div>
    <div id="form">
        <br>
        <form action="index.php" method="post">
            <br>
            <h5 class="addressInput">Add An Address</h5>
            <br>
            <input type="text" name="Street Address" id="streetAddress" placeholder="Enter your street address">
            <input type="text" name="City" id="city" placeholder="Enter your city">
            <br><br>
            <div class="text-center">
                <label for="province">Province:</label>
                    <select id="province" name="province">
                        <option value="on">ON</option>
                        <option value="ab">AB</option>
                        <option value="mb">MB</option>
                        <option value="bc">BC</option>
                        <option value="nb">NB</option>
                        <option value="nl">NL</option>
                        <option value="ns">NS</option>
                        <option value="pei">PEI</option>
                        <option value="qc">QC</option>
                        <option value="sk">SK</option>
                        <option value="nt">NT</option>
                        <option value="nu">NU</option>
                        <option value="yt">YT</option>
                    </select>
                    <label for="name">Name:</label>
                    <select id="name" name="name">
                        <option value="Value Village">Value Village</option>
                        <option value="Talize">Talize</option>
                        <option value="Salvation Army">Salvation Army</option>
                    </select>

            </div>
                <br>
                <input type="text" name="Postal Code" id="postalCode" placeholder="Enter your postal code">
                <div class="text-center">
                    <button type="button" id="submit">Submit</button>
                </div>
        </form>
            <br><br>
    </div>

</body>
<script async
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB8uDqFOpu7IyMmBHJFQtWLjU3kivRTy_o&loading=async&callback=initMap&libraries=marker">
</script>

<script>
    let map;  
    let geocoder;
    
    async function initMap() { 
        const { Map } = await google.maps.importLibrary("maps");
        
        
        map = new Map(document.getElementById("maps"), {
            center: { lat: 43.2387, lng: -79.8881 }, 
            zoom: 11,
            mapId: "410e5d7369ae59c7"
        });
  
        const mohawk_marker = new google.maps.marker.AdvancedMarkerElement({
    position: { lat: 43.2387, lng: -79.881 },
    map,
    title: "Mohawk College"
});

const customMarker = document.createElement('div');
customMarker.innerHTML = `
    <img src="https://maps.google.com/mapfiles/kml/paddle/pink-stars.png" 
         style="width: 40px; height: 40px;">
`;
let find_location = document.getElementById("findLocation");
    find_location.addEventListener("click", function() {
        if(navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPositionOnMap);
        } else {
            alert("Geolocation is not supported by this browser.");
        }
    });

function showPositionOnMap(position){
    let user_location = new google.maps.marker.AdvancedMarkerElement({
        position: { lat: position.coords.latitude, lng: position.coords.longitude },
        map,
        title: "Your Location",
        content: customMarker
    });
}

 value_village_marker_1 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat:43.226471 , lng: -79.761542 },
        map,
        title: "Value Village"
    });
    makeInfoMarker(value_village_marker_1, contentString1,"114 Irene Avenue, Stoney Creek ON L8G 2B5 Stoney Creek Ontario Canada");
    
     value_village_marker_2 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat:43.231400, lng:-79.857300 },
        map,
        title: "Value Village"
    });
    makeInfoMarker(value_village_marker_2, contentString1, "530 Fennell Avenue East, Hamilton ON L8V 1S9 Hamilton Ontario Canada");
    
     value_village_marker_3 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat:43.198985, lng:-80.019127 },
        map,
        title: "Value Village"
    });
    makeInfoMarker(value_village_marker_3, contentString1, "100 Portia Drive, Ancaster ON L0R Ancaster Ontario Canada");
    
     value_village_marker_4 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat:43.3325, lng:-79.8912 },
        map,
        title: "Value Village"
    });
    makeInfoMarker(value_village_marker_4, contentString1, "63 Main Street South, Waterdown ON L8B Waterdown Ontario Canada");

     value_village_marker_5 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat:43.39438, lng:-79.79493 },
        map,
        title: "Value Village"
    });
    makeInfoMarker(value_village_marker_5, contentString1, "2030 Appleby Line, Burlington ON L7L 6M6 Burlington Ontario Canada");
    
    
     talize_marker = new google.maps.marker.AdvancedMarkerElement({
        position: { lat: 43.2094, lng:-79.8912 },
        map,
        title: "Talize"
    });
    makeInfoMarker(talize_marker, contentString2,"1400 Upper James St, Hamilton, ON L9B 1K3");
    
     talize_marker_2 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat: 43.226424, lng: -79.881965 },
        map,
        title: "Talize"
    });
    makeInfoMarker(talize_marker_2, contentString2,"1144 Courtland Ave E, Kitchener, ON N2C 1N2");
    
     salvation_army_marker_1 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat: 43.254062, lng: -79.861829 },
        map,
        title: "Salvation Army"
    });
    makeInfoMarker(salvation_army_marker_1, contentString3,"250 King St E, Hamilton, ON L8N 1B7");
    
     salvation_army_marker_2 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat: 43.226424, lng: -79.881965 },
        map,
        title: "Salvation Army"
    });
    makeInfoMarker(salvation_army_marker_2, contentString3,"879 Upper James St, Hamilton, ON L9C 3A3");
    
     salvation_army_marker_3 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat: 43.235889, lng: -79.758229 },
        map,
        title: "Salvation Army"
    });
    makeInfoMarker(salvation_army_marker_3, contentString3,"2500 Barton St E, Hamilton, ON L8E 3K8");

    let vvmarkers = [
        value_village_marker_1,
        value_village_marker_2,
        value_village_marker_3,
        value_village_marker_4,
        value_village_marker_5
    ];
    let tsmarkers = [
        talize_marker,
        talize_marker_2
    ];
    let samarkers = [
        salvation_army_marker_1,
        salvation_army_marker_2,
        salvation_army_marker_3
    ];
    
    let markers = [];
    
    function codeAddress(){
    let streetAddress = document.getElementById("streetAddress").value;
    let city = document.getElementById("city").value;
    let province = document.getElementById("province").value;
    let postalCode = document.getElementById("postalCode").value;
    let title = document.getElementById("name").value;
    
    let address = streetAddress + ", " + city + ", " + province + ", " + postalCode;
    geocoder = new google.maps.Geocoder();
    
    geocoder.geocode( { 'address': address}, function(results, status) {
        if (status == 'OK') {
            const userInputLocation= document.createElement('div');
            userInputLocation.innerHTML = `
                <img src="https://maps.google.com/mapfiles/kml/paddle/purple-stars.png" 
                style="width: 40px; height: 40px;">
                `;
                let marker = new google.maps.marker.AdvancedMarkerElement({
                    position: results[0].geometry.location,
                    content: userInputLocation,
                    title: title
                });
                marker.setMap(map);
                
                switch(title){
                    case "Value Village":
                        vvmarkers.push(marker);
                        break;
                    case "Talize":
                        tsmarkers.push(marker);
                        break;
                    case "Salvation Army":
                        samarkers.push(marker);
                        break;
                            }
                            
                            makeInfoMarker(marker, "<h6>" + title + "</h6>", address);
                        } else {
                            alert('Geocode was not successful due to: ' + status);
                        }
                    });
                }
                
                
                
                let geocode = document.getElementById("submit");
                geocode.addEventListener("click", codeAddress);
                
                    let onlySA = document.getElementById("onlySA");
                    onlySA.addEventListener("click", function() {
                        vvmarkers.forEach(marker => marker.setMap(null));
                        tsmarkers.forEach(marker => marker.setMap(null));
                        samarkers.forEach(marker => marker.setMap(map));
                    });
                
                    let onlyTS = document.getElementById("onlyTS");
                    onlyTS.addEventListener("click", function() {
                        vvmarkers.forEach(marker => marker.setMap(null));
                        samarkers.forEach(marker => marker.setMap(null));
                        tsmarkers.forEach(marker => marker.setMap(map));
                    });
                
                    let onlyVV = document.getElementById("onlyVV");
                    onlyVV.addEventListener("click", function() {
                        tsmarkers.forEach(marker => marker.setMap(null));
                        samarkers.forEach(marker => marker.setMap(null));
                        vvmarkers.forEach(marker => marker.setMap(map));
                    });
                
                    let all = document.getElementById("all");   
                    all.addEventListener("click", function() {
                        vvmarkers.forEach(marker => marker.setMap(map));
                        tsmarkers.forEach(marker => marker.setMap(map));
                        samarkers.forEach(marker => marker.setMap(map));
                    });
                }

function makeInfoMarker(marker, content, address) {
    let infoWindow = new google.maps.InfoWindow({
        content: content + address
    });

    marker.addListener("click", () => {
        infoWindow.open(map, marker);
        shouldFocus = false;
    });
    
}

let contentString1 = `
    <div>
        <h6>Value Village</h6>
        <p>Savers Value Village Inc. is a publicly held, for-profit thrift store retailer headquartered in Bellevue, Washington, United States, offering second hand merchandise, with supermajority ownership by private equity firm Ares Management</p>
    </div>
`;

let contentString2 = `
    <div>
        <h6>Talize</h6>
        <p>Talize is a proudly Canadian owned and operated national 
            for-profit retailer offering quality resale apparel and 
            housewares at unbeatable prices. As Canada’s newest and 
            most unique shopping experience we offer new, like-new 
            and vintage items all under one roof.</p>
    </div>
`;

let contentString3 = `
    <div>
        <h6>Salvation Army</h6>
        <p>Shop thrift & donate secondhand goods at your local Salvation Army Thrift Store, where we care for our communities & the planet we share.</p>
    </div>
`;
</script> 

</html>