<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MWD-Assignment 2</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="header">
    <h1>♻️ Shop Second Hand ♻️</h1>
    <h5>Find all the thirft-shops in the area</h5>
    <p>"Thrifting is important because it helps reduce waste by reusing items that would otherwise go to landfills, saves money by providing affordable options, supports local communities by funding charities through thrift store profits, and allows people to express their unique style through a wider variety of unique finds; essentially, it's a sustainable and budget-friendly way to shop while contributing positively to the environment and society. "</p>
        <div id="btns">
            <button id="onlyVV">Only Value Village</button>
            <button id="onlyTS">Only Talize</button>
            <button id="onlySA">Only Salvation Army</button>
            <button id="all">Display All</button>
        </div>
    </div>
    
    <div id="maps"></div>
    
    <div class="text-center">
        <button id="findLocation">Find My Location</button>
        <div id="coords"></div>
    </div>
    <div id="form">
        <br>
        <form action="index.php" method="post">
            <br>
            <h5>Add An Address</h5>
            <br>
            <input type="text" name="Street Address" id="streetAddress" placeholder="Enter your street address">
            <input type="text" name="City" id="city" placeholder="Enter your city">
            <br><br>
            <div class="text-center">
            <label for="province">Province:</label>
                <select id="province" name="province">
                <option value="on">ON</option>
                <option value="ab">AB</option>
                <option value="mb">MB</option>
                <option value="bc">BC</option>
                <option value="nb">NB</option>
                <option value="nl">NL</option>
                <option value="ns">NS</option>
                <option value="pei">PEI</option>
                <option value="qc">QC</option>
                <option value="sk">SK</option>
                <option value="nt">NT</option>
                <option value="nu">NU</option>
                <option value="yt">YT</option>
                </select>
            </div>
                <br>
                <input type="text" name="Postal Code" id="postalCode" placeholder="Enter your postal code">
                <input type="text" name="Name" id="name" placeholder="Enter the location name">
                <br>
                <div class="text-center">
            <button type="button" id="submit">Submit</button>
        </div>
        </form>
            <br><br>
    </div>

</body>
<script async
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB8uDqFOpu7IyMmBHJFQtWLjU3kivRTy_o&loading=async&callback=initMap&libraries=marker">
</script>

<script>
    let map;  
    let geocoder;
    
    async function initMap() { 
        const { Map } = await google.maps.importLibrary("maps");
        
        
        map = new Map(document.getElementById("maps"), {
            center: { lat: 43.2387, lng: -79.8881 }, 
            zoom: 11,
            mapId: "410e5d7369ae59c7"
        });
  
        const mohawk_marker = new google.maps.marker.AdvancedMarkerElement({
    position: { lat: 43.2387, lng: -79.881 },
    map,
    title: "Mohawk College"
});

const customMarker = document.createElement('div');
customMarker.innerHTML = `
    <img src="https://maps.google.com/mapfiles/kml/paddle/pink-stars.png" 
         style="width: 40px; height: 40px;">
`;
let find_location = document.getElementById("findLocation");
    find_location.addEventListener("click", function() {
        if(navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPositionOnMap);
        } else {
            alert("Geolocation is not supported by this browser.");
        }
    });

function showPositionOnMap(position){
    let user_location = new google.maps.marker.AdvancedMarkerElement({
        position: { lat: position.coords.latitude, lng: position.coords.longitude },
        map,
        title: "Your Location",
        content: customMarker
    });
}

 value_village_marker_1 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat:43.226471 , lng: -79.761542 },
        map,
        title: "Value Village"
    });
    
     value_village_marker_2 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat:43.231400, lng:-79.857300 },
        map,
        title: "Value Village"
    });
    
     value_village_marker_3 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat:43.198985, lng:-80.019127 },
        map,
        title: "Value Village"
    });
    
     value_village_marker_4 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat:43.3325, lng:-79.8912 },
        map,
        title: "Value Village"
    });

     value_village_marker_5 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat:43.39438, lng:-79.79493 },
        map,
        title: "Value Village"
    });
    
    
     talize_marker = new google.maps.marker.AdvancedMarkerElement({
        position: { lat: 43.2094, lng:-79.8912 },
        map,
        title: "Talize"
    });
    
     talize_marker_2 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat: 43.226424, lng: -79.881965 },
        map,
        title: "Talize"
    });
    
     salvation_army_marker_1 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat: 43.254062, lng: -79.861829 },
        map,
        title: "Salvation Army"
    });
    
     salvation_army_marker_2 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat: 43.226424, lng: -79.881965 },
        map,
        title: "Salvation Army"
    });
    
     salvation_army_marker_3 = new google.maps.marker.AdvancedMarkerElement({
        position: { lat: 43.235889, lng: -79.758229 },
        map,
        title: "Salvation Army"
    });
    let vvmarkers = [
        value_village_marker_1,
        value_village_marker_2,
        value_village_marker_3,
        value_village_marker_4,
        value_village_marker_5
    ];
    let tsmarkers = [
        talize_marker,
        talize_marker_2
    ];
    let samarkers = [
        salvation_army_marker_1,
        salvation_army_marker_2,
        salvation_army_marker_3
    ];

    let onlySA = document.getElementById("onlySA");
    onlySA.addEventListener("click", function() {
        vvmarkers.forEach(marker => marker.setMap(null));
        tsmarkers.forEach(marker => marker.setMap(null));
        samarkers.forEach(marker => marker.setMap(map));
    });

    let onlyTS = document.getElementById("onlyTS");
    onlyTS.addEventListener("click", function() {
        vvmarkers.forEach(marker => marker.setMap(null));
        samarkers.forEach(marker => marker.setMap(null));
        tsmarkers.forEach(marker => marker.setMap(map));
    });

    let onlyVV = document.getElementById("onlyVV");
    onlyVV.addEventListener("click", function() {
        tsmarkers.forEach(marker => marker.setMap(null));
        samarkers.forEach(marker => marker.setMap(null));
        vvmarkers.forEach(marker => marker.setMap(map));
    });

    let all = document.getElementById("all");   
    all.addEventListener("click", function() {
        vvmarkers.forEach(marker => marker.setMap(map));
        tsmarkers.forEach(marker => marker.setMap(map));
        samarkers.forEach(marker => marker.setMap(map));
    });
}
const userInputLocation= document.createElement('div');
userInputLocation.innerHTML = `
    <img src="https://maps.google.com/mapfiles/kml/paddle/purple-stars.png" 
         style="width: 40px; height: 40px;">
`;

function codeAddress(){
    let streetAddress = document.getElementById("streetAddress").value;
    let city = document.getElementById("city").value;
    let province = document.getElementById("province").value;
    let postalCode = document.getElementById("postalCode").value;
    let title = document.getElementById("desc").value;

    let address = streetAddress + ", " + city + ", " + province + ", " + postalCode;
    geocoder = new google.maps.Geocoder();

    geocoder.geocode( { 'address': address}, function(results, status) {
        if (status == 'OK') {
            map.setCenter(results[0].geometry.location);
            let marker = new google.maps.marker.AdvancedMarkerElement({
                map: map,
                position: results[0].geometry.location,
                content: userInputLocation,
                title: title
            });
        } else {
            alert('Geocode was not successful due to: ' + status);
        }
    });
}

let geocode = document.getElementById("submit");
geocode.addEventListener("click", codeAddress);

</script> 

</html>